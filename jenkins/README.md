# jenkins
## install by yum
 * wget -O /etc/yum.repos.d/jenkins.repo http://pkg.jenkins-ci.org/redhat/jenkins.repo
 * rpm --import https://jenkins-ci.org/redhat/jenkins-ci.org.key
 * yum install jenkins

## keystore
 * cd /var/lib/jenkins
 * mkdir .ssl
 * keytool -genkey -alias jenkins-ssl-cert -keyalg RSA -keystore .ssl/keystore.jks -storepass Password01!

## jenkins sysconfig
 * vi /etc/sysconfig/jenkins
 * JENKINS_HTTPS_KEYSTORE="/var/lib/jenkins/.ssl/.keystore"
 * JENKINS_HTTPS_KEYSTORE_PASSWORD="Password01!"

## change port number
 * defalt port(8080,8009) number is already used by tomcat

## add plugins
 ### download and add to /var/lib/jenkins/plugin
 * git-plugin
 * scm-api
 * git-client

## jenkins plugins to install
 * git
 * ghprb
 * github
 * github-api
 * token-macro
 * plain-credentials
 * ssh-agent
 * workflow-step-api
 * workflow-aggregator
 * credentials

## to hook with gitbucket pull-request
 # setting in gitbucket
  * create user `jenkinsbot` in gitbucket
  * add `jenkinsbot` to git-project collaborators
  * add Service Hooks `http://{jenkins-host}:{jenkins-port}/ghprbhook/` to git-project
  * goto `jenkinsbot` profile, generate token and keep it to use later
  * 
 # setting in jenkins
  * goto System-Setting
  * set `http://{gitbucket-host}:{gitbucket-port}/gitbucket/api/v3` as `GitHub Server API URL`
  * add Credetial as `secret text` and set value for Secret with token-value generated by gitbucket
  * create a new jenkins-job
  * set GitHub project-url as `http://{gitbucket-host}:{gitbucket-port}/{user or group name}/{project-name}/`
   * note: note that url is not the actual url. `gitbucket` is not required after port number.(may be a bug with gitbucket)
  * select Git for source-code
  * set Git Repository URL with actual git-repository url(can be copied from gitbucket)
  * set `Refspec` value as `+refs/pull/*:refs/remotes/origin/pr/*`
  * set `Branch Specifier(blank for 'any')` as `${sha1}`
  * select GitHub Pull Request Builder for build trigger
  * type `jenkinsbot` for Admin list
  * save the setting
 # if it's not working
  * check `http://{jenkins-host}:{jenkins-port}/log/all`
